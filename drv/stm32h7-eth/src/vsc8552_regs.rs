use super::mdio;

use ringbuf::*;
use userlib::*;

#[derive(Copy, Clone, PartialEq)]
enum Events {
    None,
    MemoryCrc(u16),
}

ringbuf!(Events, 16, Events::None);

pub struct Port<'a> {
    mdio: &'a mut dyn mdio::Controller,
    address: u8,
}

impl<'a> Port<'a> {
    pub fn new(mdio: &'a mut dyn mdio::Controller, address: u8) -> Self {
        Port {
            mdio: mdio,
            address: address,
        }
    }

    pub fn read(&mut self, page_address: u8) -> u16 {
        self.mdio.read(self.address, page_address)
    }

    pub fn write(&mut self, page_address: u8, value: u16) {
        self.mdio.write(self.address, page_address, value)
    }

    pub fn write_masked(&mut self, page_address: u8, value: u16, mask: u16) {
        self.mdio
            .write_masked(self.address, page_address, value, mask)
    }

    pub fn page(&mut self) -> Pages {
        Pages::from_u16(self.read(31)).unwrap()
    }

    pub fn set_page(&mut self, page: Pages) {
        self.write(31, page as u16)
    }

    pub fn update_page(&mut self, page: Pages) -> Pages {
        let p = self.page();
        if p != page {
            self.set_page(page);
        }
        p
    }

    pub fn restore_page(&mut self, previous: Pages, current: Pages) {
        if current != previous {
            self.set_page(previous);
        }
    }
}

#[repr(u16)]
#[derive(Copy, Clone, Debug, FromPrimitive, PartialEq)]
pub enum Pages {
    Main = 0,
    E1 = 1,
    E2 = 2,
    E3 = 3,
    G = 16,
    Test = 0x2a30,
    TokenRing = 0x52b5,
}

#[repr(u8)]
pub enum Main {
    ModeControl = 0,
    ModeStatus = 1,
    PHYId1 = 2,
    PHYId2 = 3,
    AutoNegAdvertisement = 4,
    AutoNegLinkPartner = 5,
    AugoNegExpansion = 6,
    AugoNegNextPageTransmit = 7,
    AutoNegLinkParterNextPageReceive = 8,
    _1000baseTcontrol = 9,
    _1000baseTStatus = 10,
    Clause45Access1 = 13,
    Caluse45Access2 = 14,
    _1000baseTStatusExtension1 = 15,
    _1000baseTStatusExtension2 = 17,
    _100baseTxStatusExtension = 16,
    BypassControl = 18,
    ErrorCount1 = 19,
    ErrorCount2 = 20,
    ErrorCount3 = 21,
    ExtendedControlAndStatus = 22,
    ExtendedPHYControl1 = 23,
    ExtendedPHYControl2 = 24,
    InterruptMask = 25,
    InterruptStatus = 26,
    AuxControlAndStatus = 28,
    LEDMode = 29,
    LEDBehavior = 30,
    ExtendedPageAccess = 31,
}

#[repr(u8)]
pub enum E1 {
    SerDesMediaControl = 16,
    CopperMediaCRCGoodCount = 18,
    ExtendedModeSIGDETControl = 19,
    ExtendedPHYControl3 = 20,
    ExtendedPHYControl4 = 23,
    VeriPHYControl2 = 25,
    VeriPHYControl3 = 26,
    EPGControl1 = 29,
    EPGCOntrol2 = 30,
    ExtendedPageAccess = 31,
}

#[repr(u8)]
pub enum E2 {
    CuPMDTransmitControl = 16,
    ExtendedPageAccess = 31,
}

#[repr(u8)]
pub enum E3 {
    ExtendedPageAccess = 31,
}

#[repr(u8)]
pub enum G {
    Mcu0 = 0,
    Mcu1 = 1,
    ProcessorCommand = 18,
    MACConfigAndFastLink = 19,
    ExtendedPageAccess = 31,
}

//
// Main Registers
//

bitfield::bitfield! {
    /// Contents of the Mode Control register.
    pub struct ModeControl(u16);
    /// Software reset; Self-clearing. restores SMI to default state except for
    /// sticky and super-sticky bits.
    pub soft_resetting, set_soft_reset: 15;
    /// Loopback; Enable/disable loopback (on the MII).
    pub loopback, set_loopback: 14;
    /// Forced speed select.
    ///     00: 10Mbps
    ///     01: 100Mbps
    ///     10: 1000Mbps
    ///
    /// This may not work if link partner is 100BASE-FX?
    pub speed_msb, set_speed_msb: 6;
    pub speed_lsb, set_speed_lsb: 13;
    /// Autonegotiation; Enable/disable autonegotiation.
    pub auto_negotiation, set_auto_negotiation: 12;
    /// Power-down.
    pub powered_down, set_power_down: 11;
    /// Isolate. Disconnect the MII from the datapath. Traffic entering the PHY
    /// from the MAC-side or media-side terminates inside the PHY.
    pub isolated, set_isolated: 10;
    /// Restart autonegotiation. Self-clearing.
    pub autonegotiation_restarted, restart_negotiation: 9;
    /// Full duplex.
    pub full_duplex, set_full_duplex: 8;
    /// Collision test enable.
    pub collision_test_enabled, set_collision_test_enable: 7;
    /// Allow transmit from the MII regardless of whether the PHY has
    /// determined that a valid link has been established.
    ///     false: enable transmit from MII only if PHY link established
    ///     true: enable transmit from MII regardless if PHY link established
    ///
    /// Note: this only applies in 100BASE-FX and 1000BASE-X fiber media modes
    pub unidirectional_enabled, unidirectional_enable: 5;
}

bitfield::bitfield! {
    /// Contents of the Extended PHY Control 1 register.
    pub struct ExtendedPHYControl1(u16);
    /// MAC interface mode; Super-sticky bit.
    ///     0: RGMII/SGMII
    ///     1: 1000BASE-X
    ///
    /// Note: Register MACConfigAndFastLink.mac_source must be 0 for this
    /// selection to be valid.
    pub mac_mode_1000base_x, set_mac_mode_1000base_x: 12;
    /// AMS preference; Super-sticky bit.
    ///     0: Copper preferred
    ///     1: SerDes fiber/SFP preferred
    pub ams_preference, set_ams_preference: 11;
    /// Media operating mode; Super-sticky bits.
    ///     0: Copper only
    ///     1: SerDes fiber/SFP protocol transfer mode only
    ///     2: 1000BASE-X fiber/SFP media only with autonegotiation
    ///     3: 100BASE-FX fiber/SFP on fiber media pins only
    ///     4: Automatic Media Sense (AMS)
    ///     5: AMS with copper media or SerDes/SFP protocol transfer mode
    ///     6: AMS with copper media or 1000BASE-X fiber/SFP media with
    ///         autonegotiation
    ///     7: AMS with copper media or 100BASE-FX fiber/media
    pub media_mode, set_media_mode: 10, 8;
    /// Force override of AMS mode; Sticky bits.
    ///     0: Normal
    ///     1: SerDes media only
    ///     2: Copper media only
    pub force_ams_override, set_force_ams_override: 7, 6;
    /// Enable/disable far-end loopback. This enables/disables the receive pins
    /// on the twisted pair/fiber media interface.
    pub far_end_loopback, set_far_end_loopback: 3;
}

//
// Extended Page 1 Registers
//

bitfield::bitfield! {
    /// Contents of the Ethernet Packet Generator Control 1 register.
    pub struct EPGControl1(u16);
    /// Enable EPG: disables all MAC interface transmit pins and selects EPG
    /// as the source for all data transmitted to the copper/SerDes interfaces.
    pub enabled, enable: 15;
    /// EPG start/stop; start or stop the packet generator.
    pub running, set_running: 14;
    /// Transmission duration;
    ///     0: Send 30,000,000 packets and stop
    ///     1: Send continuous, in 10,000 packet increments
    pub duration, set_duration: 13;
    /// Packet length; select one of four packet sizes.
    ///     0: 125 bytes
    ///     1: 64 bytes
    ///     2: 1518 bytes
    ///     3: 10,000 bytes (jumbo packet)
    pub packet_len, set_packet_len: 12, 11;
    /// Interpacket gab; set the interpacket gap
    ///     0: 96 ns
    ///     1: 8,192 ns
    pub interpacket_gap, set_interpacket_gap: 10;
    /// Destination address; set the lowest nibble of the 6-byte destination
    /// MAC address.
    pub dest_address, set_dest_address: 9, 6;
    /// Source address; set the lowest nibble of the 6-byte source MAC address.
    pub src_address, set_src_address: 5, 2;
    /// Payload type; set the payload type.
    ///     0: Fixed payload pattern, set pattern using EPG Control 2 register
    ///     1: Random generated payload pattern
    pub payload_type, set_payload_type: 1;
    /// Bad FCS generation; generate packets with bad frame check sequence
    pub bad_fcs, set_bad_fcs: 0;
}

//
// General Purpose Registers
//

#[repr(u16)]
pub enum ProcessorCommands {
    Nop = 0x000f,
    CalculateCRC16 = 0x0008,
    EnableDualPortMACAsSGMII = 0x00f0,
    EnableDualPortMACAsQSGMII = 0x00e0,
    EnableDualPortMedia1000BaseX = 0x0fc1,
    EnableDualPortMedia100BaseFX = 0x03d1,
}

bitfield::bitfield! {
    /// Contents of the MAC Configuration And Fast Link register.
    pub struct MACConfigAndFastLink(u16);
    /// MAC source; select active the MAC input.
    ///     0: SGMII
    ///     1: QSGMII
    ///     2: RGMII
    pub mac_source, set_mac_source: 15, 14;
    /// Fast link failure port; select fast link failure PHY source.
    ///     0: Port0
    ///     1: Port1
    ///     2-3: Reserved
    ///     _: Output disabled
    pub fast_link_failure_source, set_fast_link_failure_source: 3, 0;
}

pub fn calculate_mcu_memory_crc<'a>(
    port: &'a mut Port,
    start_address: u16,
    len: u16,
) -> u16 {
    let previous_page = port.update_page(Pages::E1);

    port.write(E1::VeriPHYControl2 as u8, start_address);
    port.write(E1::VeriPHYControl3 as u8, len);
    execute_mcu_command(port, ProcessorCommands::CalculateCRC16);

    let crc = port.read(E1::VeriPHYControl2 as u8);

    ringbuf_entry!(Events::MemoryCrc(crc));

    port.restore_page(previous_page, Pages::E1);
    crc
}

pub fn apply_firmware_patch<'a>(port: &'a mut Port) {}

pub fn pre_init<'a>(port: &'a mut Port) {
    port.set_page(Pages::Main);

    // Enable SMI broadcast.
    port.write_masked(Main::ExtendedControlAndStatus as u8, 0x0001, 0x0001);
    port.write(Main::ExtendedPHYControl2 as u8, 0x0040); // Reserved

    port.set_page(Pages::E2);
    port.write(E2::CuPMDTransmitControl as u8, 0x02be);

    port.set_page(Pages::Test);
    port.write(20, 0x4320);
    port.write(24, 0x0c00);
    port.write(9, 0x18ca);
    port.write(5, 0x1b20);

    // Disable token ring clock.
    port.write_masked(8, 0x8000, 0x8000);

    port.set_page(Pages::TokenRing);
    port.write(18, 0x0004);
    port.write(17, 0x01bd);
    port.write(16, 0x8fae);
    port.write(18, 0x000f);
    port.write(17, 0x000f);
    port.write(16, 0x8fac);
    port.write(18, 0x00a0);
    port.write(17, 0xf147);
    port.write(16, 0x97a0);
    port.write(18, 0x0005);
    port.write(17, 0x2f54);
    port.write(16, 0x8fe4);
    port.write(18, 0x0027);
    port.write(17, 0x303d);
    port.write(16, 0x9792);
    port.write(18, 0x0000);
    port.write(17, 0x0704);
    port.write(16, 0x87fe);
    port.write(18, 0x0006);
    port.write(17, 0x0150);
    port.write(16, 0x8fe0);
    port.write(18, 0x0012);
    port.write(17, 0xb00a);
    port.write(16, 0x8f82);
    port.write(18, 0x0000);
    port.write(17, 0x0d74);
    port.write(16, 0x8f80);
    port.write(18, 0x0000);
    port.write(17, 0x0012);
    port.write(16, 0x82e0);
    port.write(18, 0x0005);
    port.write(17, 0x0208);
    port.write(16, 0x83a2);
    port.write(18, 0x0000);
    port.write(17, 0x9186);
    port.write(16, 0x83b2);
    port.write(18, 0x000e);
    port.write(17, 0x3700);
    port.write(16, 0x8fb0);
    port.write(18, 0x0004);
    port.write(17, 0x9f81);
    port.write(16, 0x9688);
    port.write(18, 0x0000);
    port.write(17, 0xffff);
    port.write(16, 0x8fd2);
    port.write(18, 0x0003);
    port.write(17, 0x9fa2);
    port.write(16, 0x968a);
    port.write(18, 0x0020);
    port.write(17, 0x640b);
    port.write(16, 0x9690);
    port.write(18, 0x0000);
    port.write(17, 0x2220);
    port.write(16, 0x8258);
    port.write(18, 0x0000);
    port.write(17, 0x2a20);
    port.write(16, 0x825a);
    port.write(18, 0x0000);
    port.write(17, 0x3060);
    port.write(16, 0x825c);
    port.write(18, 0x0000);
    port.write(17, 0x3fa0);
    port.write(16, 0x825e);
    port.write(18, 0x0000);
    port.write(17, 0xe0f0);
    port.write(16, 0x83a6);
    port.write(18, 0x0000);
    port.write(17, 0x1489);
    port.write(16, 0x8f92);
    port.write(18, 0x0000);
    port.write(17, 0x7000);
    port.write(16, 0x96a2);
    port.write(18, 0x0007);
    port.write(17, 0x1448);
    port.write(16, 0x96a6);
    port.write(18, 0x00ee);
    port.write(17, 0xffdd);
    port.write(16, 0x96a0);
    port.write(18, 0x0091);
    port.write(17, 0xb06c);
    port.write(16, 0x8fe8);
    port.write(18, 0x0004);
    port.write(17, 0x1600);
    port.write(16, 0x8fea);
    port.write(18, 0x00ee);
    port.write(17, 0xff00);
    port.write(16, 0x96b0);
    port.write(18, 0x0000);
    port.write(17, 0x7000);
    port.write(16, 0x96b2);
    port.write(18, 0x0000);
    port.write(17, 0x0814);
    port.write(16, 0x96b4);
    port.write(18, 0x0068);
    port.write(17, 0x8980);
    port.write(16, 0x8f90);
    port.write(18, 0x0000);
    port.write(17, 0xd8f0);
    port.write(16, 0x83a4);
    port.write(18, 0x0000);
    port.write(17, 0x0400);
    port.write(16, 0x8fc0);
    port.write(18, 0x0050);
    port.write(17, 0x100f);
    port.write(16, 0x87fa);
    port.write(18, 0x0000);
    port.write(17, 0x0003);
    port.write(16, 0x8796);
    port.write(18, 0x00c3);
    port.write(17, 0xff98);
    port.write(16, 0x87f8);
    port.write(18, 0x0018);
    port.write(17, 0x292a);
    port.write(16, 0x8fa4);
    port.write(18, 0x00d2);
    port.write(17, 0xc46f);
    port.write(16, 0x968c);
    port.write(18, 0x0000);
    port.write(17, 0x0620);
    port.write(16, 0x97a2);
    port.write(18, 0x0013);
    port.write(17, 0x132f);
    port.write(16, 0x96a4);
    port.write(18, 0x0000);
    port.write(17, 0x0000);
    port.write(16, 0x96a8);
    port.write(18, 0x00c0);
    port.write(17, 0xa028);
    port.write(16, 0x8ffc);
    port.write(18, 0x0090);
    port.write(17, 0x1c09);
    port.write(16, 0x8fec);
    port.write(18, 0x0004);
    port.write(17, 0xa6a1);
    port.write(16, 0x8fee);
    port.write(18, 0x00b0);
    port.write(17, 0x1807);
    port.write(16, 0x8ffe);
    // ifndef VTSS_10BASE_TE
    port.set_page(Pages::E2);
    port.write(16, 0x028e);

    port.set_page(Pages::TokenRing);
    port.write(18, 0x0008);
    port.write(17, 0xa518);
    port.write(16, 0x8486);
    port.write(18, 0x006d);
    port.write(17, 0xc696);
    port.write(16, 0x8488);
    port.write(18, 0x0000);
    port.write(17, 0x0912);
    port.write(16, 0x848a);
    port.write(18, 0x0000);
    port.write(17, 0x0db6);
    port.write(16, 0x848e);
    port.write(18, 0x0059);
    port.write(17, 0x6596);
    port.write(16, 0x849c);
    port.write(18, 0x0000);
    port.write(17, 0x0514);
    port.write(16, 0x849e);
    port.write(18, 0x0041);
    port.write(17, 0x0280);
    port.write(16, 0x84a2);
    port.write(18, 0x0000);
    port.write(17, 0x0000);
    port.write(16, 0x84a4);
    port.write(18, 0x0000);
    port.write(17, 0x0000);
    port.write(16, 0x84a6);
    port.write(18, 0x0000);
    port.write(17, 0x0000);
    port.write(16, 0x84a8);
    port.write(18, 0x0000);
    port.write(17, 0x0000);
    port.write(16, 0x84aa);
    port.write(18, 0x007d);
    port.write(17, 0xf7dd);
    port.write(16, 0x84ae);
    port.write(18, 0x006d);
    port.write(17, 0x95d4);
    port.write(16, 0x84b0);
    port.write(18, 0x0049);
    port.write(17, 0x2410);
    port.write(16, 0x84b2);
    // endif

    // Enable token ring clock.
    port.set_page(Pages::Test);
    port.write_masked(8, 0x0000, 0x8000);

    // Disable SMI broadcast.
    port.set_page(Pages::Main);
    port.write_masked(Main::ExtendedControlAndStatus as u8, 0x0000, 0x0001);

    // Patch the MCU ROM if required.

    // Determine the CRC of the RAM region which would contain the patch. If this region matches the
    // patch CRC value we can skip loading the patch.
    let pre_patch_crc = calculate_mcu_memory_crc(
        port,
        FW_START_ADDRESS,
        (FW_PATCH.len() + 1) as u16,
    );

    if pre_patch_crc != FW_PATCH_CRC {
    } else {
    }
}

pub fn assert_mcu_reset<'a>(port: &'a mut Port) {
    port.set_page(Pages::G);
    // Pass the NOP cmd to Micro to insure that any consumptive patch exits There is no issue with
    // doing this on any revision since it is just a NOP on any Vitesse PHY.
    execute_mcu_command(port, ProcessorCommands::Nop);

    // Force MCU into a loop, preventing any SMI access. These writes are all in undocumented
    // registers. Comments are taken from the PHY API.

    // Disable patch vector 3 (just in case)
    port.write_masked(12, 0x0000, 0x0800);
    // Setup patch vector 3 to trap MicroWake interrupt
    port.write(9, 0x005b);
    // Loop forever on MicroWake interrupts
    port.write(10, 0x005b);
    // Enable patch vector 3
    port.write_masked(12, 0x0800, 0x0800);
    // Trigger MicroWake interrupt to allow safe reset
    port.write(G::ProcessorCommand as u8, ProcessorCommands::Nop as u16);

    // Assert reset after MCU is trapped in a loop (averts MCU-SMI access deadlock on reset)
    port.write_masked(0, 0x0000, 0x8000);
    // Make sure no MicroWake persists after reset
    port.write(G::ProcessorCommand as u8, 0x0000);
    // Disable patch vector 3
    port.write_masked(12, 0x0000, 0x0800);
}

pub fn start_mcu<'a>(port: &'a mut Port) {
    port.set_page(Pages::G);

    // Trap ROM at _MicroSmiRead+0x1d to spoof patch-presence
    port.write(3, 0x3eb7);
    // Branch to starting address of SpoofPatchPresence
    port.write(4, 0x4012);
    // Enable patch from trap described in register 3-4
    port.write(12, 0x0100);
    // Enable 8051 clock; Clear patch present; Disable PRAM clock override and addr. auto-incr;
    // Operate at 125 MHz
    port.write(0, 0x4018);
    // Release 8051 SW Reset
    port.write(0, 0xc018);
}

pub fn execute_mcu_command<'a>(port: &'a mut Port, cmd: ProcessorCommands) {
    let previous_page = port.update_page(Pages::G);

    let busy = 0x8000;
    port.write(G::ProcessorCommand as u8, busy | (cmd as u16));

    while (port.read(G::ProcessorCommand as u8) & busy) != 0 {
        hl::sleep_for(10);
    }

    port.restore_page(previous_page, Pages::G);
}

pub fn init<'a>(port: &'a mut Port) {
    port.set_page(Pages::G);

    let mut g_19 = MACConfigAndFastLink(0);
    g_19.set_mac_source(0); // SGMII
    g_19.set_fast_link_failure_source(0); // Port 0

    port.write(G::MACConfigAndFastLink as u8, g_19.0);

    execute_mcu_command(port, ProcessorCommands::EnableDualPortMACAsSGMII);
    execute_mcu_command(port, ProcessorCommands::EnableDualPortMedia100BaseFX);

    port.set_page(Pages::Main);

    // Update Extended PHY Control 1 to match the above and set 100BASE-FX
    // link partner.
    let mut main_23 = ExtendedPHYControl1(0);
    main_23.set_mac_mode_1000base_x(false); // RGMII/SGMII mode
    main_23.set_media_mode(3); // 100BASE-FX fiber only

    port.write(Main::ExtendedPHYControl1 as u8, main_23.0);
}

pub fn soft_reset<'a>(port: &'a mut Port) {
    port.set_page(Pages::Main);
    port.write_masked(Main::ModeControl as u8, 0x8000, 0x8000);

    while (port.read(Main::ModeControl as u8) & 0x8000) != 0 {
        hl::sleep_for(10);
    }
}

const FW_START_ADDRESS: u16 = 0x4000;
const FW_PATCH_CRC: u16 = 0x29e8;
const FW_PATCH: [u8; 1655] = [
    0x46, 0x4a, 0x02, 0x43, 0x37, 0x02, 0x46, 0x26, 0x02, 0x46, 0x77, 0x02,
    0x45, 0x60, 0x02, 0x45, 0xaf, 0xed, 0xff, 0xe5, 0xfc, 0x54, 0x38, 0x64,
    0x20, 0x70, 0x08, 0x65, 0xff, 0x70, 0x04, 0xed, 0x44, 0x80, 0xff, 0x22,
    0x8f, 0x19, 0x7b, 0xbb, 0x7d, 0x0e, 0x7f, 0x04, 0x12, 0x3d, 0xd7, 0xef,
    0x4e, 0x60, 0x03, 0x02, 0x41, 0xf9, 0xe4, 0xf5, 0x1a, 0x74, 0x01, 0x7e,
    0x00, 0xa8, 0x1a, 0x08, 0x80, 0x05, 0xc3, 0x33, 0xce, 0x33, 0xce, 0xd8,
    0xf9, 0xff, 0xef, 0x55, 0x19, 0x70, 0x03, 0x02, 0x41, 0xed, 0x85, 0x1a,
    0xfb, 0x7b, 0xbb, 0xe4, 0xfd, 0xff, 0x12, 0x3d, 0xd7, 0xef, 0x4e, 0x60,
    0x03, 0x02, 0x41, 0xed, 0xe5, 0x1a, 0x54, 0x02, 0x75, 0x1d, 0x00, 0x25,
    0xe0, 0x25, 0xe0, 0xf5, 0x1c, 0xe4, 0x78, 0xc5, 0xf6, 0xd2, 0x0a, 0x12,
    0x41, 0xfa, 0x7b, 0xff, 0x7d, 0x12, 0x7f, 0x07, 0x12, 0x3d, 0xd7, 0xef,
    0x4e, 0x60, 0x03, 0x02, 0x41, 0xe7, 0xc2, 0x0a, 0x74, 0xc7, 0x25, 0x1a,
    0xf9, 0x74, 0xe7, 0x25, 0x1a, 0xf8, 0xe6, 0x27, 0xf5, 0x1b, 0xe5, 0x1d,
    0x24, 0x5b, 0x12, 0x45, 0xea, 0x12, 0x3e, 0xda, 0x7b, 0xfc, 0x7d, 0x11,
    0x7f, 0x07, 0x12, 0x3d, 0xd7, 0x78, 0xcc, 0xef, 0xf6, 0x78, 0xc1, 0xe6,
    0xfe, 0xef, 0xd3, 0x9e, 0x40, 0x06, 0x78, 0xcc, 0xe6, 0x78, 0xc1, 0xf6,
    0x12, 0x41, 0xfa, 0x7b, 0xec, 0x7d, 0x12, 0x7f, 0x07, 0x12, 0x3d, 0xd7,
    0x78, 0xcb, 0xef, 0xf6, 0xbf, 0x07, 0x06, 0x78, 0xc3, 0x76, 0x1a, 0x80,
    0x1f, 0x78, 0xc5, 0xe6, 0xff, 0x60, 0x0f, 0xc3, 0xe5, 0x1b, 0x9f, 0xff,
    0x78, 0xcb, 0xe6, 0x85, 0x1b, 0xf0, 0xa4, 0x2f, 0x80, 0x07, 0x78, 0xcb,
    0xe6, 0x85, 0x1b, 0xf0, 0xa4, 0x78, 0xc3, 0xf6, 0xe4, 0x78, 0xc2, 0xf6,
    0x78, 0xc2, 0xe6, 0xff, 0xc3, 0x08, 0x96, 0x40, 0x03, 0x02, 0x41, 0xd1,
    0xef, 0x54, 0x03, 0x60, 0x33, 0x14, 0x60, 0x46, 0x24, 0xfe, 0x60, 0x42,
    0x04, 0x70, 0x4b, 0xef, 0x24, 0x02, 0xff, 0xe4, 0x33, 0xfe, 0xef, 0x78,
    0x02, 0xce, 0xa2, 0xe7, 0x13, 0xce, 0x13, 0xd8, 0xf8, 0xff, 0xe5, 0x1d,
    0x24, 0x5c, 0xcd, 0xe5, 0x1c, 0x34, 0xf0, 0xcd, 0x2f, 0xff, 0xed, 0x3e,
    0xfe, 0x12, 0x46, 0x0d, 0x7d, 0x11, 0x80, 0x0b, 0x78, 0xc2, 0xe6, 0x70,
    0x04, 0x7d, 0x11, 0x80, 0x02, 0x7d, 0x12, 0x7f, 0x07, 0x12, 0x3e, 0x9a,
    0x8e, 0x1e, 0x8f, 0x1f, 0x80, 0x03, 0xe5, 0x1e, 0xff, 0x78, 0xc5, 0xe6,
    0x06, 0x24, 0xcd, 0xf8, 0xa6, 0x07, 0x78, 0xc2, 0x06, 0xe6, 0xb4, 0x1a,
    0x0a, 0xe5, 0x1d, 0x24, 0x5c, 0x12, 0x45, 0xea, 0x12, 0x3e, 0xda, 0x78,
    0xc5, 0xe6, 0x65, 0x1b, 0x70, 0x82, 0x75, 0xdb, 0x20, 0x75, 0xdb, 0x28,
    0x12, 0x46, 0x02, 0x12, 0x46, 0x02, 0xe5, 0x1a, 0x12, 0x45, 0xf5, 0xe5,
    0x1a, 0xc3, 0x13, 0x12, 0x45, 0xf5, 0x78, 0xc5, 0x16, 0xe6, 0x24, 0xcd,
    0xf8, 0xe6, 0xff, 0x7e, 0x08, 0x1e, 0xef, 0xa8, 0x06, 0x08, 0x80, 0x02,
    0xc3, 0x13, 0xd8, 0xfc, 0xfd, 0xc4, 0x33, 0x54, 0xe0, 0xf5, 0xdb, 0xef,
    0xa8, 0x06, 0x08, 0x80, 0x02, 0xc3, 0x13, 0xd8, 0xfc, 0xfd, 0xc4, 0x33,
    0x54, 0xe0, 0x44, 0x08, 0xf5, 0xdb, 0xee, 0x70, 0xd8, 0x78, 0xc5, 0xe6,
    0x70, 0xc8, 0x75, 0xdb, 0x10, 0x02, 0x40, 0xfd, 0x78, 0xc2, 0xe6, 0xc3,
    0x94, 0x17, 0x50, 0x0e, 0xe5, 0x1d, 0x24, 0x62, 0x12, 0x42, 0x08, 0xe5,
    0x1d, 0x24, 0x5c, 0x12, 0x42, 0x08, 0x20, 0x0a, 0x03, 0x02, 0x40, 0x76,
    0x05, 0x1a, 0xe5, 0x1a, 0xc3, 0x94, 0x04, 0x50, 0x03, 0x02, 0x40, 0x3a,
    0x22, 0xe5, 0x1d, 0x24, 0x5c, 0xff, 0xe5, 0x1c, 0x34, 0xf0, 0xfe, 0x12,
    0x46, 0x0d, 0x22, 0xff, 0xe5, 0x1c, 0x34, 0xf0, 0xfe, 0x12, 0x46, 0x0d,
    0x22, 0xe4, 0xf5, 0x19, 0x12, 0x46, 0x43, 0x20, 0xe7, 0x1e, 0x7b, 0xfe,
    0x12, 0x42, 0xf9, 0xef, 0xc4, 0x33, 0x33, 0x54, 0xc0, 0xff, 0xc0, 0x07,
    0x7b, 0x54, 0x12, 0x42, 0xf9, 0xd0, 0xe0, 0x4f, 0xff, 0x74, 0x2a, 0x25,
    0x19, 0xf8, 0xa6, 0x07, 0x12, 0x46, 0x43, 0x20, 0xe7, 0x03, 0x02, 0x42,
    0xdf, 0x54, 0x03, 0x64, 0x03, 0x70, 0x03, 0x02, 0x42, 0xcf, 0x7b, 0xcb,
    0x12, 0x43, 0x2c, 0x8f, 0xfb, 0x7b, 0x30, 0x7d, 0x03, 0xe4, 0xff, 0x12,
    0x3d, 0xd7, 0xc3, 0xef, 0x94, 0x02, 0xee, 0x94, 0x00, 0x50, 0x2a, 0x12,
    0x42, 0xec, 0xef, 0x4e, 0x70, 0x23, 0x12, 0x43, 0x04, 0x60, 0x0a, 0x12,
    0x43, 0x12, 0x70, 0x0c, 0x12, 0x43, 0x1f, 0x70, 0x07, 0x12, 0x46, 0x39,
    0x7b, 0x03, 0x80, 0x07, 0x12, 0x46, 0x39, 0x12, 0x46, 0x43, 0xfb, 0x7a,
    0x00, 0x7d, 0x54, 0x80, 0x3e, 0x12, 0x42, 0xec, 0xef, 0x4e, 0x70, 0x24,
    0x12, 0x43, 0x04, 0x60, 0x0a, 0x12, 0x43, 0x12, 0x70, 0x0f, 0x12, 0x43,
    0x1f, 0x70, 0x0a, 0x12, 0x46, 0x39, 0xe4, 0xfb, 0xfa, 0x7d, 0xee, 0x80,
    0x1e, 0x12, 0x46, 0x39, 0x7b, 0x01, 0x7a, 0x00, 0x7d, 0xee, 0x80, 0x13,
    0x12, 0x46, 0x39, 0x12, 0x46, 0x43, 0x54, 0x40, 0xfe, 0xc4, 0x13, 0x13,
    0x54, 0x03, 0xfb, 0x7a, 0x00, 0x7d, 0xee, 0x12, 0x38, 0xbd, 0x7b, 0xff,
    0x12, 0x43, 0x2c, 0xef, 0x4e, 0x70, 0x07, 0x74, 0x2a, 0x25, 0x19, 0xf8,
    0xe4, 0xf6, 0x05, 0x19, 0xe5, 0x19, 0xc3, 0x94, 0x02, 0x50, 0x03, 0x02,
    0x42, 0x15, 0x22, 0xe5, 0x19, 0x24, 0x17, 0xfd, 0x7b, 0x20, 0x7f, 0x04,
    0x12, 0x3d, 0xd7, 0x22, 0xe5, 0x19, 0x24, 0x17, 0xfd, 0x7f, 0x04, 0x12,
    0x3d, 0xd7, 0x22, 0x7b, 0x22, 0x7d, 0x18, 0x7f, 0x06, 0x12, 0x3d, 0xd7,
    0xef, 0x64, 0x01, 0x4e, 0x22, 0x7d, 0x1c, 0xe4, 0xff, 0x12, 0x3e, 0x9a,
    0xef, 0x54, 0x1b, 0x64, 0x0a, 0x22, 0x7b, 0xcc, 0x7d, 0x10, 0xff, 0x12,
    0x3d, 0xd7, 0xef, 0x64, 0x01, 0x4e, 0x22, 0xe5, 0x19, 0x24, 0x17, 0xfd,
    0x7f, 0x04, 0x12, 0x3d, 0xd7, 0x22, 0xd2, 0x08, 0x75, 0xfb, 0x03, 0xab,
    0x7e, 0xaa, 0x7d, 0x7d, 0x19, 0x7f, 0x03, 0x12, 0x3e, 0xda, 0xe5, 0x7e,
    0x54, 0x0f, 0x24, 0xf3, 0x60, 0x03, 0x02, 0x43, 0xe9, 0x12, 0x46, 0x5a,
    0x12, 0x46, 0x61, 0xd8, 0xfb, 0xff, 0x20, 0xe2, 0x35, 0x13, 0x92, 0x0c,
    0xef, 0xa2, 0xe1, 0x92, 0x0b, 0x30, 0x0c, 0x2a, 0xe4, 0xf5, 0x10, 0x7b,
    0xfe, 0x12, 0x43, 0xff, 0xef, 0xc4, 0x33, 0x33, 0x54, 0xc0, 0xff, 0xc0,
    0x07, 0x7b, 0x54, 0x12, 0x43, 0xff, 0xd0, 0xe0, 0x4f, 0xff, 0x74, 0x2a,
    0x25, 0x10, 0xf8, 0xa6, 0x07, 0x05, 0x10, 0xe5, 0x10, 0xc3, 0x94, 0x02,
    0x40, 0xd9, 0x12, 0x46, 0x5a, 0x12, 0x46, 0x61, 0xd8, 0xfb, 0x54, 0x05,
    0x64, 0x04, 0x70, 0x27, 0x78, 0xc4, 0xe6, 0x78, 0xc6, 0xf6, 0xe5, 0x7d,
    0xff, 0x33, 0x95, 0xe0, 0xef, 0x54, 0x0f, 0x78, 0xc4, 0xf6, 0x12, 0x44,
    0x0a, 0x20, 0x0c, 0x0c, 0x12, 0x46, 0x5a, 0x12, 0x46, 0x61, 0xd8, 0xfb,
    0x13, 0x92, 0x0d, 0x22, 0xc2, 0x0d, 0x22, 0x12, 0x46, 0x5a, 0x12, 0x46,
    0x61, 0xd8, 0xfb, 0x54, 0x05, 0x64, 0x05, 0x70, 0x1e, 0x78, 0xc4, 0x7d,
    0xb8, 0x12, 0x43, 0xf5, 0x78, 0xc1, 0x7d, 0x74, 0x12, 0x43, 0xf5, 0xe4,
    0x78, 0xc1, 0xf6, 0x22, 0x7b, 0x01, 0x7a, 0x00, 0x7d, 0xee, 0x7f, 0x92,
    0x12, 0x38, 0xbd, 0x22, 0xe6, 0xfb, 0x7a, 0x00, 0x7f, 0x92, 0x12, 0x38,
    0xbd, 0x22, 0xe5, 0x10, 0x24, 0x17, 0xfd, 0x7f, 0x04, 0x12, 0x3d, 0xd7,
    0x22, 0x78, 0xc1, 0xe6, 0xfb, 0x7a, 0x00, 0x7d, 0x74, 0x7f, 0x92, 0x12,
    0x38, 0xbd, 0xe4, 0x78, 0xc1, 0xf6, 0xf5, 0x11, 0x74, 0x01, 0x7e, 0x00,
    0xa8, 0x11, 0x08, 0x80, 0x05, 0xc3, 0x33, 0xce, 0x33, 0xce, 0xd8, 0xf9,
    0xff, 0x78, 0xc4, 0xe6, 0xfd, 0xef, 0x5d, 0x60, 0x44, 0x85, 0x11, 0xfb,
    0xe5, 0x11, 0x54, 0x02, 0x25, 0xe0, 0x25, 0xe0, 0xfe, 0xe4, 0x24, 0x5b,
    0xfb, 0xee, 0x12, 0x45, 0xed, 0x12, 0x3e, 0xda, 0x7b, 0x40, 0x7d, 0x11,
    0x7f, 0x07, 0x12, 0x3d, 0xd7, 0x74, 0xc7, 0x25, 0x11, 0xf8, 0xa6, 0x07,
    0x7b, 0x11, 0x7d, 0x12, 0x7f, 0x07, 0x12, 0x3d, 0xd7, 0xef, 0x4e, 0x60,
    0x09, 0x74, 0xe7, 0x25, 0x11, 0xf8, 0x76, 0x04, 0x80, 0x07, 0x74, 0xe7,
    0x25, 0x11, 0xf8, 0x76, 0x0a, 0x05, 0x11, 0xe5, 0x11, 0xc3, 0x94, 0x04,
    0x40, 0x9a, 0x78, 0xc6, 0xe6, 0x70, 0x15, 0x78, 0xc4, 0xe6, 0x60, 0x10,
    0x75, 0xd9, 0x38, 0x75, 0xdb, 0x10, 0x7d, 0xfe, 0x12, 0x44, 0xb8, 0x7d,
    0x76, 0x12, 0x44, 0xb8, 0x79, 0xc6, 0xe7, 0x78, 0xc4, 0x66, 0xff, 0x60,
    0x03, 0x12, 0x40, 0x25, 0x78, 0xc4, 0xe6, 0x70, 0x09, 0xfb, 0xfa, 0x7d,
    0xfe, 0x7f, 0x8e, 0x12, 0x38, 0xbd, 0x22, 0x7b, 0x01, 0x7a, 0x00, 0x7f,
    0x8e, 0x12, 0x38, 0xbd, 0x22, 0xe4, 0xf5, 0xfb, 0x7d, 0x1c, 0xe4, 0xff,
    0x12, 0x3e, 0x9a, 0xad, 0x07, 0xac, 0x06, 0xec, 0x54, 0xc0, 0xff, 0xed,
    0x54, 0x3f, 0x4f, 0xf5, 0x20, 0x30, 0x06, 0x2c, 0x30, 0x01, 0x08, 0xa2,
    0x04, 0x72, 0x03, 0x92, 0x07, 0x80, 0x21, 0x30, 0x04, 0x06, 0x7b, 0xcc,
    0x7d, 0x11, 0x80, 0x0d, 0x30, 0x03, 0x06, 0x7b, 0xcc, 0x7d, 0x10, 0x80,
    0x04, 0x7b, 0x66, 0x7d, 0x16, 0xe4, 0xff, 0x12, 0x3d, 0xd7, 0xee, 0x4f,
    0x24, 0xff, 0x92, 0x07, 0xaf, 0xfb, 0x74, 0x26, 0x2f, 0xf8, 0xe6, 0xff,
    0xa6, 0x20, 0x20, 0x07, 0x39, 0x8f, 0x20, 0x30, 0x07, 0x34, 0x30, 0x00,
    0x31, 0x20, 0x04, 0x2e, 0x20, 0x03, 0x2b, 0xe4, 0xf5, 0xff, 0x75, 0xfc,
    0xc2, 0xe5, 0xfc, 0x30, 0xe0, 0xfb, 0xaf, 0xfe, 0xef, 0x20, 0xe3, 0x1a,
    0xae, 0xfd, 0x44, 0x08, 0xf5, 0xfe, 0x75, 0xfc, 0x80, 0xe5, 0xfc, 0x30,
    0xe0, 0xfb, 0x8f, 0xfe, 0x8e, 0xfd, 0x75, 0xfc, 0x80, 0xe5, 0xfc, 0x30,
    0xe0, 0xfb, 0x05, 0xfb, 0xaf, 0xfb, 0xef, 0xc3, 0x94, 0x04, 0x50, 0x03,
    0x02, 0x44, 0xc5, 0xe4, 0xf5, 0xfb, 0x22, 0xe5, 0x7e, 0x54, 0x0f, 0x64,
    0x01, 0x70, 0x23, 0xe5, 0x7e, 0x30, 0xe4, 0x1e, 0x90, 0x47, 0xd0, 0xe0,
    0x44, 0x02, 0xf0, 0x54, 0xfb, 0xf0, 0x90, 0x47, 0xd4, 0xe0, 0x44, 0x04,
    0xf0, 0x7b, 0x03, 0x7d, 0x5b, 0x7f, 0x5d, 0x12, 0x36, 0x29, 0x7b, 0x0e,
    0x80, 0x1c, 0x90, 0x47, 0xd0, 0xe0, 0x54, 0xfd, 0xf0, 0x44, 0x04, 0xf0,
    0x90, 0x47, 0xd4, 0xe0, 0x54, 0xfb, 0xf0, 0x7b, 0x02, 0x7d, 0x5b, 0x7f,
    0x5d, 0x12, 0x36, 0x29, 0x7b, 0x06, 0x7d, 0x60, 0x7f, 0x63, 0x12, 0x36,
    0x29, 0x22, 0xe5, 0x7e, 0x30, 0xe5, 0x35, 0x30, 0xe4, 0x0b, 0x7b, 0x02,
    0x7d, 0x33, 0x7f, 0x35, 0x12, 0x36, 0x29, 0x80, 0x10, 0x7b, 0x01, 0x7d,
    0x33, 0x7f, 0x35, 0x12, 0x36, 0x29, 0x90, 0x47, 0xd2, 0xe0, 0x44, 0x04,
    0xf0, 0x90, 0x47, 0xd2, 0xe0, 0x54, 0xf7, 0xf0, 0x90, 0x47, 0xd1, 0xe0,
    0x44, 0x10, 0xf0, 0x7b, 0x05, 0x7d, 0x84, 0x7f, 0x86, 0x12, 0x36, 0x29,
    0x22, 0xfb, 0xe5, 0x1c, 0x34, 0xf0, 0xfa, 0x7d, 0x10, 0x7f, 0x07, 0x22,
    0x54, 0x01, 0xc4, 0x33, 0x54, 0xe0, 0xf5, 0xdb, 0x44, 0x08, 0xf5, 0xdb,
    0x22, 0xf5, 0xdb, 0x75, 0xdb, 0x08, 0xf5, 0xdb, 0x75, 0xdb, 0x08, 0x22,
    0xab, 0x07, 0xaa, 0x06, 0x7d, 0x10, 0x7f, 0x07, 0x12, 0x3e, 0xda, 0x7b,
    0xff, 0x7d, 0x10, 0x7f, 0x07, 0x12, 0x3d, 0xd7, 0xef, 0x4e, 0x60, 0xf3,
    0x22, 0x12, 0x44, 0xc2, 0x30, 0x0c, 0x03, 0x12, 0x42, 0x12, 0x78, 0xc4,
    0xe6, 0xff, 0x60, 0x03, 0x12, 0x40, 0x25, 0x22, 0xe5, 0x19, 0x24, 0x17,
    0x54, 0x1f, 0x44, 0x80, 0xff, 0x22, 0x74, 0x2a, 0x25, 0x19, 0xf8, 0xe6,
    0x22, 0x12, 0x46, 0x72, 0x12, 0x46, 0x68, 0x90, 0x47, 0xfa, 0xe0, 0x54,
    0xf8, 0x44, 0x02, 0xf0, 0x22, 0xe5, 0x7e, 0xae, 0x7d, 0x78, 0x04, 0x22,
    0xce, 0xa2, 0xe7, 0x13, 0xce, 0x13, 0x22, 0xe4, 0x78, 0xc4, 0xf6, 0xc2,
    0x0d, 0x78, 0xc1, 0xf6, 0x22, 0xc2, 0x0c, 0xc2, 0x0b, 0x22, 0x22,
];
